<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extension Tabs Test</title>
    <link rel="stylesheet" href="sidebar.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-text {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
        }
        .test-text p {
            margin: 10px 0;
            line-height: 1.6;
        }
        .instructions {
            background-color: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #2196F3;
        }
        .debug-panel {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-top: 20px;
            border: 1px solid #ddd;
        }
        .debug-panel button {
            display: block;
            width: 100%;
            margin: 5px 0;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            cursor: pointer;
        }
        .debug-panel button:hover {
            background: #f0f0f0;
        }

        /* æ ‡ç­¾é¡µåŸºæœ¬æ ·å¼ */
        .tabs {
            display: flex;
            border-bottom: 1px solid #e1e4e8;
            background-color: white;
            margin: 0;
        }

        .tab {
            flex: 1;
            padding: 12px 8px;
            text-align: center;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
            font-size: 13px;
            font-weight: 500;
            color: #606770;
            background: none;
            border: none;
        }

        .tab.active {
            border-bottom-color: #4285f4;
            color: #4285f4;
        }

        .tab:hover:not(.active) {
            background-color: #f8f9fa;
            color: #4285f4;
        }

        /* æ ‡ç­¾é¡µå†…å®¹æ ·å¼ */
        .tab-content {
            display: none;
            padding: 20px;
            background: white;
            border: 1px solid #e1e4e8;
            border-top: none;
        }

        .tab-content.active {
            display: block;
        }

        /* ä¾§è¾¹æ åŸºæœ¬æ ·å¼ */
        .english-explainer-sidebar {
            width: 320px;
            margin: 20px auto;
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            overflow: hidden;
        }

        .sidebar-content {
            padding: 16px;
        }

        /* å†…å®¹æ ·å¼ */
        .section {
            margin-bottom: 20px;
        }

        .section h4 {
            margin: 0 0 10px;
            color: #4285f4;
            font-size: 16px;
        }

        .definition-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 15px;
        }

        .bullet-list {
            list-style: none;
            padding-left: 0;
        }

        .bullet-list li {
            position: relative;
            padding-left: 20px;
            margin-bottom: 8px;
        }

        .bullet-list li:before {
            content: "â€¢";
            color: #4285f4;
            position: absolute;
            left: 0;
        }

        .vocab-item {
            border: 1px solid #e1e4e8;
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .alt-card {
            border: 1px solid #e1e4e8;
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="instructions">
        <h3>æ‰©å±•æ ‡ç­¾é¡µåŠŸèƒ½æµ‹è¯•</h3>
        <p><strong>æµ‹è¯•æ­¥éª¤ï¼š</strong></p>
        <ol>
            <li>é€‰ä¸­ä¸‹é¢çš„æ–‡æœ¬</li>
            <li>ç‚¹å‡»"æ¨¡æ‹Ÿè§£é‡Š"æŒ‰é’®</li>
            <li>ç­‰å¾…ä¾§è¾¹æ å‡ºç°</li>
            <li>å°è¯•ç‚¹å‡»ä¸‰ä¸ªæ ‡ç­¾é¡µï¼Œè§‚å¯Ÿå†…å®¹æ˜¯å¦æ­£ç¡®åˆ‡æ¢</li>
            <li>æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°çš„æ—¥å¿—ä¿¡æ¯</li>
        </ol>
    </div>

    <div class="test-text">
        <h3>æµ‹è¯•æ–‡æœ¬</h3>
        <p>Our tutoring rates. We have 100% free tutoring sessions! Schedule a tutoring session.</p>
        <p>è¯·é€‰ä¸­è¿™æ®µæ–‡æœ¬è¿›è¡Œæµ‹è¯•ã€‚</p>
    </div>

    <div class="debug-panel">
        <h4>è°ƒè¯•é¢æ¿</h4>
        <button onclick="simulateExplain()">æ¨¡æ‹Ÿè§£é‡Š</button>
        <button onclick="testTabSwitch('meaning')">åˆ‡æ¢åˆ° Meaning</button>
        <button onclick="testTabSwitch('vocabulary')">åˆ‡æ¢åˆ° Vocabulary</button>
        <button onclick="testTabSwitch('alternatives')">åˆ‡æ¢åˆ° Alternatives</button>
        <button onclick="debugTabStructure()">è°ƒè¯•æ ‡ç­¾ç»“æ„</button>
    </div>

    <!-- æ¨¡æ‹Ÿçš„ä¾§è¾¹æ å®¹å™¨ -->
    <div id="sidebar-container" style="max-width: 800px; margin: 20px auto;"></div>

    <script src="content.js"></script>
    <script>
        // æ¨¡æ‹Ÿè§£é‡ŠåŠŸèƒ½
        function simulateExplain() {
            console.log('ğŸ§ª å¼€å§‹æ¨¡æ‹Ÿè§£é‡ŠåŠŸèƒ½');
            
            const text = "Our tutoring rates. We have 100% free tutoring sessions! Schedule a tutoring session.";
            
            // æ¨¡æ‹Ÿè°ƒç”¨ processJsonResponse å‡½æ•°ï¼Œå°±åƒå®é™…æ‰©å±•ä¸­é‚£æ ·
            const mockApiResponse = {
                "meaning": {
                    "definition": "This text is advertising tutoring services with an emphasis on free sessions and scheduling.",
                    "usageContext": [
                        "Educational service advertising",
                        "Marketing materials for tutoring companies",
                        "Student recruitment communications"
                    ],
                    "grammarStructure": [
                        "Simple declarative statements",
                        "Imperative sentence for call-to-action",
                        "Use of percentages for emphasis"
                    ],
                    "usageNotes": [
                        "The phrase '100% free' is used for marketing impact",
                        "Multiple short sentences create urgency",
                        "Direct language appeals to cost-conscious students"
                    ]
                },
                "vocabulary": [
                    {
                        "word": "tutoring",
                        "type": "noun",
                        "definition": "Private instruction given to a student",
                        "usage": "She offers math tutoring to high school students",
                        "synonyms": "coaching, teaching, instruction"
                    },
                    {
                        "word": "rates",
                        "type": "noun",
                        "definition": "The prices charged for a service",
                        "usage": "Our hourly rates are very competitive",
                        "synonyms": "prices, fees, charges"
                    },
                    {
                        "word": "sessions",
                        "type": "noun",
                        "definition": "Periods of time devoted to a particular activity",
                        "usage": "Each tutoring session lasts one hour",
                        "synonyms": "meetings, appointments, classes"
                    }
                ],
                "alternatives": [
                    {
                        "phrase": "Our lesson pricing",
                        "description": "More professional way to refer to costs",
                        "formality": "Formal",
                        "example": "Our lesson pricing is transparent and competitive"
                    },
                    {
                        "phrase": "Complimentary tutoring available",
                        "description": "Emphasizes value rather than cost",
                        "formality": "Professional",
                        "example": "We offer complimentary tutoring to qualifying students"
                    },
                    {
                        "phrase": "Book your learning session",
                        "description": "More educational focus than commercial",
                        "formality": "Neutral",
                        "example": "Book your personalized learning session today"
                    }
                ]
            };

            // ä½¿ç”¨ processJsonResponse å‡½æ•°å¤„ç†æ¨¡æ‹Ÿæ•°æ®ï¼Œå°±åƒçœŸå®APIå“åº”ä¸€æ ·
            const explanation = processJsonResponse(mockApiResponse);

            // åˆ›å»ºä¾§è¾¹æ ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
            if (!window.sidebar) {
                createSidebar();
            }

            // æ›´æ–°ä¾§è¾¹æ å†…å®¹
            updateSidebarContent(text, explanation);
        }

        // æ‰‹åŠ¨æµ‹è¯•æ ‡ç­¾åˆ‡æ¢
        function testTabSwitch(tabId) {
            console.log(`ğŸ§ª æ‰‹åŠ¨æµ‹è¯•åˆ‡æ¢åˆ°: ${tabId}`);
            
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            console.log(`æ‰¾åˆ° ${tabs.length} ä¸ªæ ‡ç­¾, ${tabContents.length} ä¸ªå†…å®¹åŒºåŸŸ`);
            
            // ç§»é™¤æ‰€æœ‰æ´»åŠ¨çŠ¶æ€
            tabs.forEach(t => t.classList.remove('active'));
            tabContents.forEach(c => c.classList.remove('active'));
            
            // æ¿€æ´»æŒ‡å®šæ ‡ç­¾
            const targetTab = document.querySelector(`[data-tab="${tabId}"]`);
            const targetContent = document.getElementById(`${tabId}-tab`);
            
            if (targetTab && targetContent) {
                targetTab.classList.add('active');
                targetContent.classList.add('active');
                console.log(`âœ… æ‰‹åŠ¨åˆ‡æ¢æˆåŠŸ: ${tabId}`);
            } else {
                console.log(`âŒ æ‰‹åŠ¨åˆ‡æ¢å¤±è´¥:`, {
                    targetTab: !!targetTab,
                    targetContent: !!targetContent,
                    expectedContentId: `${tabId}-tab`
                });
            }
        }

        // è°ƒè¯•æ ‡ç­¾ç»“æ„
        function debugTabStructure() {
            console.log('ğŸ” è°ƒè¯•æ ‡ç­¾ç»“æ„:');
            
            const tabs = document.querySelectorAll('.tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            console.log('æ ‡ç­¾é¡µæŒ‰é’®:');
            tabs.forEach((tab, i) => {
                console.log(`  ${i}: data-tab="${tab.getAttribute('data-tab')}" active=${tab.classList.contains('active')} listener=${tab.hasAttribute('data-tab-listener')}`);
            });
            
            console.log('æ ‡ç­¾é¡µå†…å®¹:');
            tabContents.forEach((content, i) => {
                console.log(`  ${i}: id="${content.id}" active=${content.classList.contains('active')}`);
            });
        }

        // é¡µé¢åŠ è½½åçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
            
            // ç­‰å¾…ä¸€ä¸‹å†æ‰§è¡Œæ¨¡æ‹Ÿï¼Œç¡®ä¿æ‰€æœ‰è„šæœ¬éƒ½åŠ è½½å®Œæˆ
            setTimeout(() => {
                console.log('ğŸ§ª è‡ªåŠ¨æ‰§è¡Œæ¨¡æ‹Ÿè§£é‡Šä»¥è¿›è¡Œæµ‹è¯•');
                simulateExplain();
            }, 500);
        });
    </script>
</body>
</html> 